<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SAM.gov Matcher - Opportunity Finder</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <div class="header-title">
                    <h1>üéØ SAM.gov Opportunity Matcher</h1>
                    <p class="subtitle">Find and track government contract opportunities</p>
                </div>
                <div class="header-buttons">
                    <button type="button" class="btn-daily-alert" id="dailyAlertBtn" title="Enable daily email alerts">
                        üîî Daily Alert: OFF
                    </button>
                    <button type="button" class="btn-new-search" id="newSearchBtn">
                        üîç New Search
                    </button>
                </div>
            </div>
        </header>

        <main>
            <!-- Status Display -->
            <div id="statusDisplay" class="status-display hidden">
                <div class="status-icon" id="statusIcon">‚è≥</div>
                <div class="status-text" id="statusText">Waiting...</div>
            </div>

            <!-- Previous Searches Section -->
            <div class="searches-section">
                <div class="form-group">
                    <label for="searchHistory">Previous Searches:</label>
                    <div class="search-history-row">
                        <select id="searchHistory" class="search-dropdown">
                            <option value="">-- Select a previous search --</option>
                        </select>
                        <button type="button" class="btn-primary" id="loadSearchBtn">
                            üì• Load
                        </button>
                        <button type="button" class="btn-delete-search" id="deleteSearchBtn" title="Delete selected search">
                            üóëÔ∏è
                        </button>
                    </div>
                    <small>Select from your last 10 searches to reload results</small>
                </div>
            </div>

            <!-- API Call Counter -->
            <div class="api-counter-row">
                <div class="api-counter" id="apiCounter">
                    <span class="api-counter-label">Daily Searches Remaining:</span>
                    <span class="api-counter-value" id="apiCounterValue">10/10</span>
                </div>
            </div>

            <!-- Opportunities Display -->
            <div id="opportunitiesSection" class="opportunities-section">
                <h2>üìã Your Opportunities</h2>
                <div id="opportunitiesContent">
                    <p class="empty-state">Select a previous search from the dropdown or click "New Search" to find opportunities.</p>
                </div>
            </div>

        </main>

        <footer>
            <p>SAM.gov Matcher v2.0 | Powered by Make.com & Google Maps API</p>
            <button type="button" class="btn-help" id="showHelpBtn">‚ùì How to Use</button>
        </footer>
    </div>

    <!-- Search Modal -->
    <div id="searchModal" class="modal hidden">
        <div class="modal-overlay" id="modalOverlay"></div>
        <div class="modal-content">
            <div class="modal-header">
                <h2>üîç Search Opportunities</h2>
                <button type="button" class="modal-close" id="modalCloseBtn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="searchForm" class="search-form">

                    <!-- User Identification -->
                    <div class="form-section">
                        <h2>üë§ Your Information</h2>
                        <div class="form-group">
                            <label for="userEmail">Your Email: <span class="required">*</span></label>
                            <input
                                type="email"
                                id="userEmail"
                                name="user_email"
                                placeholder="your.email@company.com"
                                required
                            >
                            <small>Used to save and retrieve your search settings</small>
                        </div>
                        <div class="form-group">
                            <label for="userName">Your Name:</label>
                            <input
                                type="text"
                                id="userName"
                                name="user_name"
                                placeholder="John Smith"
                            >
                            <small>Optional: For display purposes</small>
                        </div>
                    </div>

                    <!-- Search Keywords -->
                    <div class="form-section">
                        <h2>üîç What Are You Looking For?</h2>
                        <div class="form-group">
                            <label for="searchKeywords">Search Keywords:</label>
                            <input
                                type="text"
                                id="searchKeywords"
                                name="keywords"
                                placeholder="HVAC, plumbing, construction, maintenance, repair"
                            >
                            <small>Enter keywords related to what your business does (comma-separated). This searches opportunity titles and descriptions.</small>
                        </div>

                        <!-- NAICS Codes -->
                        <div class="form-group">
                            <label for="naicsCodes">Industry Codes (NAICS - Optional):</label>
                            <input
                                type="text"
                                id="naicsCodes"
                                name="naics_filter"
                                placeholder="238220, 236220, 238210"
                            >
                            <small>Leave blank to search all industries, or enter specific NAICS codes (e.g., 238220 for HVAC)</small>
                        </div>
                    </div>

                    <!-- Company Information -->
                    <div class="form-section">
                        <h2>üè¢ Your Company</h2>

                        <!-- ZIP Code -->
                        <div class="form-group">
                            <label for="companyZip">Your ZIP Code:</label>
                            <input
                                type="text"
                                id="companyZip"
                                name="company_zip"
                                placeholder="92019"
                                pattern="[0-9]{5}"
                                maxlength="5"
                            >
                            <small>Optional: Used for location-based filtering</small>
                        </div>

                        <!-- Business Type (Set-Asides) -->
                        <div class="form-group">
                            <label>Business Certifications (Optional):</label>
                            <div class="checkbox-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" name="set_aside" value="NONE" checked>
                                    <span>Open Competition (any business)</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="set_aside" value="SBA">
                                    <span>Small Business</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="set_aside" value="SDVOSBC">
                                    <span>Veteran-Owned</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="set_aside" value="8A">
                                    <span>8(a) Certified</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="set_aside" value="WOSB">
                                    <span>Women-Owned</span>
                                </label>
                                <label class="checkbox-label">
                                    <input type="checkbox" name="set_aside" value="HUBZone">
                                    <span>HUBZone</span>
                                </label>
                            </div>
                            <small>Check all that apply to see opportunities for your business type</small>
                        </div>
                    </div>

                    <!-- Filters -->
                    <div class="form-section">
                        <h2>üéØ Filters (Optional)</h2>

                        <!-- Minimum Contract Value -->
                        <div class="form-group">
                            <label for="minValue">
                                Minimum Contract Value:
                                <strong>$<span id="minValueDisplay">0</span></strong>
                            </label>
                            <input
                                type="range"
                                id="minValue"
                                name="min_value"
                                min="0"
                                max="500000"
                                value="0"
                                step="10000"
                                class="slider"
                            >
                            <div class="slider-labels">
                                <span>$0 (Any)</span>
                                <span>$250k</span>
                                <span>$500k</span>
                            </div>
                            <small>Set to $0 to see all contract sizes</small>
                        </div>

                        <!-- Minimum Days Until Deadline -->
                        <div class="form-group">
                            <label for="minDays">
                                Minimum Days Until Deadline:
                                <strong><span id="minDaysValue">0</span> days</strong>
                            </label>
                            <input
                                type="range"
                                id="minDays"
                                name="min_days"
                                min="0"
                                max="30"
                                value="0"
                                step="1"
                                class="slider"
                            >
                            <div class="slider-labels">
                                <span>0 (Show All)</span>
                                <span>15 days</span>
                                <span>30 days</span>
                            </div>
                            <small>Filter out opportunities with deadlines too soon</small>
                        </div>
                    </div>

                    <!-- Additional Options -->
                    <div class="form-section">
                        <h2>üîß Additional Options</h2>

                        <!-- Include Awarded Toggle -->
                        <div class="form-group">
                            <label class="toggle-label">
                                <input type="checkbox" name="include_awarded" id="includeAwarded">
                                <span class="toggle-switch"></span>
                                <span>Include already-awarded contracts (for research)</span>
                            </label>
                            <small>Check this to see past awards for competitive intelligence</small>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div class="form-actions">
                        <button type="submit" class="btn-primary" id="submitBtn">
                            üöÄ Search Opportunities
                        </button>
                    </div>

                </form>
            </div>
        </div>
    </div>

    <!-- Daily Alert Modal -->
    <div id="dailyAlertModal" class="modal hidden">
        <div class="modal-overlay" id="dailyAlertOverlay"></div>
        <div class="modal-content daily-alert-modal">
            <div class="modal-header">
                <h2>üîî Daily Alert Settings</h2>
                <button type="button" class="modal-close" id="dailyAlertCloseBtn">&times;</button>
            </div>
            <div class="modal-body">
                <p class="alert-description">
                    Get an email notification when new opportunities match your search criteria.
                    Uses <strong>1 search credit per day</strong> when enabled.
                </p>

                <div class="form-group">
                    <label for="alertEmail">Email for Notifications: <span class="required">*</span></label>
                    <input
                        type="email"
                        id="alertEmail"
                        placeholder="your.email@company.com"
                        required
                    >
                </div>

                <div class="form-group">
                    <label for="alertSearchTemplate">Use Search Settings From:</label>
                    <select id="alertSearchTemplate" class="search-dropdown">
                        <option value="">-- Select a previous search --</option>
                    </select>
                    <small>Select which search criteria to use for daily alerts</small>
                </div>

                <div class="alert-status" id="alertStatus">
                    <span class="status-indicator off"></span>
                    <span class="status-text">Daily alerts are currently <strong>OFF</strong></span>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn-enable-alert" id="toggleAlertBtn">
                        üîî Enable Daily Alerts
                    </button>
                </div>

                <div class="alert-info">
                    <p>üìß You'll receive an email only when <strong>new</strong> opportunities are found that you haven't seen before.</p>
                    <p>‚è∞ Searches run automatically once per day.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Welcome/Directions Modal -->
    <div class="welcome-overlay hidden" id="welcomeOverlay"></div>
    <div id="welcomeModal" class="welcome-modal hidden">
        <div class="welcome-content">
            <div class="welcome-header">
                <h2>üëã Welcome to SAM.gov Matcher!</h2>
            </div>
            <div class="welcome-body">
                <p class="welcome-intro">Find government contract opportunities tailored to your business.</p>

                <div class="welcome-steps">
                    <div class="welcome-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4>üîç Search by Keywords</h4>
                            <p>Enter keywords like "HVAC", "construction", "IT services" - we'll search through ALL government opportunities to find matches.</p>
                        </div>
                    </div>

                    <div class="welcome-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4>üéØ Optional Filters</h4>
                            <p>Narrow results by industry codes (NAICS), business type, contract value, or deadline. Missing data? We'll show it anyway with "Unknown" - don't miss opportunities!</p>
                        </div>
                    </div>

                    <div class="welcome-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4>üìä Review Results</h4>
                            <p>Browse matching opportunities with all key details. Click any opportunity to view full details on SAM.gov.</p>
                        </div>
                    </div>

                    <div class="welcome-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4>üì• Saved Searches</h4>
                            <p>Your last 10 searches are saved automatically. Reload them anytime from the dropdown menu.</p>
                        </div>
                    </div>
                </div>

                <div class="welcome-note">
                    <strong>‚ö†Ô∏è Daily Limit:</strong> You have <strong>10 searches per day</strong> (resets every 24 hours).<br>
                    <strong>üí° Tip:</strong> Enable <strong>Daily Alerts</strong> to get email notifications for new opportunities!
                </div>

                <div class="welcome-actions">
                    <button type="button" class="btn-get-started" id="welcomeCloseBtn">
                        üöÄ Get Started
                    </button>
                </div>

                <label class="welcome-checkbox">
                    <input type="checkbox" id="dontShowAgain">
                    <span>Don't show this again</span>
                </label>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
